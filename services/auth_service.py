# services/auth_service.py

# üîê Usu√°rio administrador
USUARIO_MASTER = "Admin"
SENHA_MASTER = "admin@2026" 

# üîó Mapeamento simples usu√°rio ‚Üí CC
USUARIOS_CC = {
    'Admin': ['admin@2026'],
    '1011': ['4057'],
    '1012': ['9584'],
    '1021': ['7254'],
    '1022': ['3953'],
    '1023': ['6084'],
    '1031': ['6934'],
    '1032': ['4118'],
    '1033': ['3831'],
    '1041': ['7547'], 
    '1042': ['3724'],
    '1043': ['1604'], 
    '1044': ['9546'],
    '1045': ['2055'], 
    '1046': ['9271'], 
    '1047': ['3349'],
    '1048': ['6209'], 
    '1049': ['4273'], 
    '1051': ['9164'], 
    '1052': ['3075'], 
    '1053': ['5542'],
    '1054': ['4164'], 
    '1055': ['2559'], 
    '1056': ['2132'], 
    '1057': ['7048'], 
    '1058': ['4622'],
    '1059': ['2926'], 
    '1061': ['6763'], 
    '1071': ['4337'], 
    '1072': ['1775'], 
    '1081': ['9886'],
    '1082': ['3964'], 
    '1083': ['4862'], 
    '1091': ['2591'], 
    '1092': ['3800'], 
    '1093': ['1382'],
    '1094': ['7115'], 
    '1095': ['6654'], 
    '1111': ['7011'], 
    '1112': ['3346'], 
    '1113': ['5188'],
    '1114': ['1383'], 
    '1115': ['7067'], 
    '1116': ['8559'], 
    '1117': ['8189'], 
    '1118': ['1052'],
    '1119': ['7654'], 
    '1121': ['1913'], 
    '1122': ['7922'], 
    '1123': ['2767'], 
    '1124': ['3784'],
    '1125': ['3964'], 
    '1126': ['2655'], 
    '1127': ['2526'], 
    '1128': ['2798'], 
    '1129': ['5612'],
    '1131': ['5039'], 
    '1132': ['4655'], 
    '1133': ['7894'], 
    '1134': ['3755'], 
    '1135': ['3068'],
    '1136': ['5294'], 
    '1141': ['1265'], 
    '1142': ['7295'], 
    '1143': ['7892'], 
    '1144': ['5575'],
    '1145': ['1847'], 
    '1146': ['6162'], 
    '1147': ['5151'], 
    '1148': ['8837'], 
    '1149': ['9055'],
    '1150': ['1499'], 
    '1151': ['4009'], 
    '1152': ['8478'], 
    '1153': ['9856'], 
    '1161': ['5680'],
    '1200': ['7486'], 
    '1201': ['9632'], 
    '1202': ['7412'], 
    '1203': ['8521'], 
    '1204': ['6412'],
    '1205': ['9810'], 
    '1206': ['5973'], 
    '1207': ['8462'], 
    '1208': ['5971'], 
    '1209': ['3519'],
    '1210': ['7458'], 
    '1211': ['9756'], 
    '1212': ['2587'], 
    '1213': ['2589'], 
    '1214': ['6120'],
    '1215': ['1710'], 
    '1216': ['7214'], 
    '1217': ['9550'], 
    '1218': ['7957'], 
    '1219': ['1627'],
    '1220': ['9658'], 
    '1221': ['8913'], 
    '1222': ['8647'], 
    '1223': ['6384'], 
    '1224': ['5066'],
    '1225': ['8775'], 
    '1226': ['6009'], 
    '1227': ['6172'], 
    '1228': ['4783'], 
    '1229': ['4720'],
    '1230': ['9541'], 
    '1231': ['3562'], 
    '1232': ['4455'], 
    '1233': ['6998'], 
    '1234': ['3603'],
    '1300': ['9651'], 
    '1301': ['7541'], 
    '1302': ['4567'], 
    '1303': ['1324'], 
    '1304': ['7777'],
    '1305': ['4444'], 
    '1306': ['3333'], 
    '1307': ['7823'], 
    '1308': ['0908'], 
    '1309': ['7386'],
    '1310': ['7765'], 
    '1311': ['0235'], 
    '1312': ['5225'], 
    '1313': ['4377'], 
    '1314': ['2720'],
    '1511': ['6952'], 
    '1512': ['7988'], 
    '1513': ['9735'], 
    '1514': ['7232'], 
    '1515': ['1674'],
    '1516': ['7414'], 
    '1521': ['3801'], 
    '1601': ['8436'], 
    '2000': ['6901'], 
    '2001': ['2793'],
    '2002': ['8450'], 
    '2003': ['5703'], 
    '2004': ['1429'], 
    '2005': ['5356'], 
    '2006': ['9170'],
    '2007': ['5357'], 
    '2008': ['6334'], 
    '2009': ['9005'], 
    '2010': ['6887'], 
    '2011': ['3125'],
    '2012': ['6762'], 
    '2013': ['6416'], 
    '2014': ['5779'], 
    '2015': ['5968'], 
    '7902': ['6767'],
    '7903': ['3506'], 
    '7904': ['9999'], 
    '7907': ['4602'], 
    '7910': ['1215'], 
    '7911': ['9943'],
    '7912': ['2842'], 
    '7913': ['5207'], 
    '7914': ['2406'], 
    '7915': ['6302'], 
    '8902': ['4249'],
    '8903': ['4561'], 
    '8904': ['9084'], 
    '8907': ['2823'], 
    '8910': ['8698'], 
    '8911': ['5219'],
    '8912': ['7760'], 
    '8913': ['5913'], 
    '8914': ['6754'], 
    '8915': ['9184'], 
    '9901': ['9521'],
    '9902': ['6683'], 
    '9903': ['7104'], 
    '9904': ['2412'], 
    '9905': ['6795'], 
    '9906': ['1629'],
    '9907': ['8267'], 
    '9908': ['3267'], 
    '9909': ['8765'], 
    '9910': ['2269'], 
    '9911': ['4484'],
    '9912': ['4089'], 
    '9913': ['8335'], 
    '9914': ['6346'], 
    '9915': ['5690']
}

def autenticar(usuario, senha):
    """
    Valida usu√°rio e senha.
    Retorna um dict com dados do usu√°rio ou None.
    """

    if not usuario or not senha:
        return None

    # üîê Admin
    if usuario == USUARIO_MASTER:
        if senha == SENHA_MASTER:
            return {
                "usuario": usuario,
                "perfil": "admin",
            }
        return None

    # üë§ Usu√°rio comum
    senha_correta = USUARIOS_CC.get(usuario)

    if not senha_correta:
        return None

    # senha_correta √© lista ‚Üí ['8462']
    if senha == senha_correta[0]:
        return {
            "usuario": usuario,
            "perfil": "usuario",
        }

    return None


def is_master(usuario):
    return usuario == USUARIO_MASTER


def get_cc_permitidos(usuario):
    """
    Retorna uma LISTA de CCs permitidos para o usu√°rio.
    """

    if not usuario:
        return []

    if is_master(usuario):
        # Admin v√™ tudo
        return []

    # Usu√°rio comum v√™ apenas o pr√≥prio CC
    return [usuario]